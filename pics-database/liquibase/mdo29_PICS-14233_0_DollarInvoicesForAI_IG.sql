--liquibase formatted sql

--changeset mdo:29
--preConditions onFail MARK_RAN
--onUpdateSQL IGNORE

INSERT INTO invoice(accountID,tableType,invoiceType,createdBy,updatedBy,creationDate,updateDate,dueDate,STATUS,totalAmount,amountApplied,commissionableAmount,payingFacilities,qbSync,currency)
SELECT a.id, 'I','Upgrade',37951,37951,NOW(),NOW(),DATE_ADD(CURDATE(),INTERVAL 1 WEEK),'Paid','0.00','0.00','0.00',c.payingFacilities,1,rc.currency
FROM accounts a
JOIN contractor_info c ON a.id = c.id
JOIN ref_country rc ON a.country = rc.isoCode
WHERE a.id IN (1978,2310,3987,7656,10125,12431,13761,15423,20445,22605,22607,22661,22670,22674,22681,22691,22725,22730,22801,22806,22866,22883,22971,22973,23231,23255,23283,23357,23410,23415,23545,23719,23872,23897,24058,24089,24146,24152,24157,24192,24196,24210,24215,24227,24232,24244,24265,24307,24320,24373,24374,24424,24462,24575,24598,24603,24610,24620,24756,24798,24810,24828,24833,24860,24919,24940,24946,24956,24984,25005,25042,25058,25065,25072,25074,25117,25135,25165,25181,25207,25245,25249,25345,25360,25374,25384,25390,25394,25402,25405,25476,25532,25618,25659,25767,25822,25881,26010,26035,26044,26139,26225,26245,26282,26316,26322,26323,26352,26416,26469,26529,26548,26564,26582,26816,26825,26826,26851,26874,26886,26887,26908,26910,26963,26965,27006,27012,27013,27071,27077,27124,27131,27134,27142,27144,27159,27166,27169,27175,27187,27281,27306,27349,27361,27455,27519,27562,27571,27575,27580,27620,27631,27659,27679,27705,27716,27730,27767,27818,27855,27939,27965,28001,28002,28051,28060,28069,28136,28166,28167,28184,28185,28221,28233,28277,28285,28338,28356,28368,28388,28424,28429,28459,28478,28480,28497,28543,28603,28619,28623,28645,28649,28669,28707,28711,28765,28777,28829,28839,28927,28938,28946,28950,28981,28999,29058,29060,29109,29133,29163,29206,29235,29252,29314,29323,29551,29566,29585,29602,29657,29736,29742,29746,29808,29837,29862,29867,29891,29993,29994,30009,30050,30057,30063,30064,30125,30136,30153,30158,30169,30178,30183,30206,30232,30233,30244,30268,30269,30305,30323,30337,30341,30343,30365,30424,30447,30454,30458,30474,30484,30492,30508,30535,30540,30571,30576,30579,30595,30649,30673,30700,30718,30719,30735,30799,30827,30866,30881,31020,31052,31547,31625,31641,31662,31684,31690,31736,31829,32104,32235,32423,32547,32599,32634,32764,32769,32846,32949,33124,33174,33285,33341,33390,33405,33525,33575,33701,33900,33935,33983,34022,34069,34089,34186,34187,34386,34664,34676,34744,34758,34897,35153,35533,35578,36482,36612,36768,36806,37291,37296,37305,37470,37534,37653,38022,38086,39032,39352,39625,39722,39728,39737,39762,39782,40062,40188,40312,40361,40372,40626,40635,40846,40847,41297,41348,41529,41535,41765,41923,41930,42130,42331,42332,42435,42444,42661,42836,43144,43163,43224,43231,43305,43573,43673,43775,44028,44092,44124,44250,44325,44490,44716,44813,44823,44865,44924,45110,45523,45544,45718,45744,45832,45837,45921,46606,46710,46945,47573,47666,47865,47872,48348,48636,48917,48943,48972,49102,49170,49436,49438,49528,49549,49694,49827,50500,50507,50838,50981,50996,51130,51769,52008,52305,52455,52590,52808,53171,53678,53691,53747,54090,54135,54174,54485,54784,54816,54820,54835,54909,55237,55719,55936,56293,56308,56339,56344,56368,56489,56554,56607,56613,56692,56708,57355,57410,58007,58202);

INSERT INTO invoice_item(invoiceID,feeID,amount,originalAmount,createdBy,updatedBy,creationDate,updateDate,transactionType,revenueStartDate,revenueFinishDate)
SELECT i.id, 310,99.00,99.00,37951,37951,NOW(),NOW(),'I',NOW(),c.paymentExpires
FROM invoice i
JOIN contractor_info c ON i.accountID = c.id
JOIN contractor_fee cf ON c.id = cf.conID AND cf.feeClass = 'InsureGUARD'
WHERE i.createdBy = 37951 AND i.creationDate > DATE_SUB(CURDATE(),INTERVAL 3 DAY)
AND c.id IN (1978,2310,3987,7656,10125,12431,13761,15423,20445,22605,22607,22661,22670,22674,22681,22691,22725,22730,22801,22806,22866,22883,22971,22973,23231,23255,23283,23357,23410,23415,23545,23719,23872,23897,24058,24089,24146,24152,24157,24192,24196,24210,24215,24227,24232,24244,24265,24307,24320,24373,24374,24424,24462,24575,24598,24603,24610,24620,24756,24798,24810,24828,24833,24860,24919,24940,24946,24956,24984,25005,25042,25058,25065,25072,25074,25117,25135,25165,25181,25207,25245,25249,25345,25360,25374,25384,25390,25394,25402,25405,25476,25532,25618,25659,25767,25822,25881,26010,26035,26044,26139,26225,26245,26282,26316,26322,26323,26352,26416,26469,26529,26548,26564,26582,26816,26825,26826,26851,26874,26886,26887,26908,26910,26963,26965,27006,27012,27013,27071,27077,27124,27131,27134,27142,27144,27159,27166,27169,27175,27187,27281,27306,27349,27361,27455,27519,27562,27571,27575,27580,27620,27631,27659,27679,27705,27716,27730,27767,27818,27855,27939,27965,28001,28002,28051,28060,28069,28136,28166,28167,28184,28185,28221,28233,28277,28285,28338,28356,28368,28388,28424,28429,28459,28478,28480,28497,28543,28603,28619,28623,28645,28649,28669,28707,28711,28765,28777,28829,28839,28927,28938,28946,28950,28981,28999,29058,29060,29109,29133,29163,29206,29235,29252,29314,29323,29551,29566,29585,29602,29657,29736,29742,29746,29808,29837,29862,29867,29891,29993,29994,30009,30050,30057,30063,30064,30125,30136,30153,30158,30169,30178,30183,30206,30232,30233,30244,30268,30269,30305,30323,30337,30341,30343,30365,30424,30447,30454,30458,30474,30484,30492,30508,30535,30540,30571,30576,30579,30595,30649,30673,30700,30718,30719,30735,30799,30827,30866,30881,31020,31052,31547,31625,31641,31662,31684,31690,31736,31829,32104,32235,32423,32547,32599,32634,32764,32769,32846,32949,33124,33174,33285,33341,33390,33405,33525,33575,33701,33900,33935,33983,34022,34069,34089,34186,34187,34386,34664,34676,34744,34758,34897,35153,35533,35578,36482,36612,36768,36806,37291,37296,37305,37470,37534,37653,38022,38086,39032,39352,39625,39722,39728,39737,39762,39782,40062,40188,40312,40361,40372,40626,40635,40846,40847,41297,41348,41529,41535,41765,41923,41930,42130,42331,42332,42435,42444,42661,42836,43144,43163,43224,43231,43305,43573,43673,43775,44028,44092,44124,44250,44325,44490,44716,44813,44823,44865,44924,45110,45523,45544,45718,45744,45832,45837,45921,46606,46710,46945,47573,47666,47865,47872,48348,48636,48917,48943,48972,49102,49170,49436,49438,49528,49549,49694,49827,50500,50507,50838,50981,50996,51130,51769,52008,52305,52455,52590,52808,53171,53678,53691,53747,54090,54135,54174,54485,54784,54816,54820,54835,54909,55237,55719,55936,56293,56308,56339,56344,56368,56489,56554,56607,56613,56692,56708,57355,57410,58007,58202);

INSERT INTO invoice_item(invoiceID,feeID,amount,originalAmount,createdBy,updatedBy,creationDate,updateDate,transactionType,revenueStartDate,revenueFinishDate)
SELECT i.id, 310,-99.00,99.00,37951,37951,NOW(),NOW(),'I',NOW(),c.paymentExpires
FROM invoice i
JOIN contractor_info c ON i.accountID = c.id
JOIN contractor_fee cf ON c.id = cf.conID AND cf.feeClass = 'InsureGUARD'
WHERE i.createdBy = 37951 AND i.creationDate > DATE_SUB(CURDATE(),INTERVAL 3 DAY)
AND c.id IN (1978,2310,3987,7656,10125,12431,13761,15423,20445,22605,22607,22661,22670,22674,22681,22691,22725,22730,22801,22806,22866,22883,22971,22973,23231,23255,23283,23357,23410,23415,23545,23719,23872,23897,24058,24089,24146,24152,24157,24192,24196,24210,24215,24227,24232,24244,24265,24307,24320,24373,24374,24424,24462,24575,24598,24603,24610,24620,24756,24798,24810,24828,24833,24860,24919,24940,24946,24956,24984,25005,25042,25058,25065,25072,25074,25117,25135,25165,25181,25207,25245,25249,25345,25360,25374,25384,25390,25394,25402,25405,25476,25532,25618,25659,25767,25822,25881,26010,26035,26044,26139,26225,26245,26282,26316,26322,26323,26352,26416,26469,26529,26548,26564,26582,26816,26825,26826,26851,26874,26886,26887,26908,26910,26963,26965,27006,27012,27013,27071,27077,27124,27131,27134,27142,27144,27159,27166,27169,27175,27187,27281,27306,27349,27361,27455,27519,27562,27571,27575,27580,27620,27631,27659,27679,27705,27716,27730,27767,27818,27855,27939,27965,28001,28002,28051,28060,28069,28136,28166,28167,28184,28185,28221,28233,28277,28285,28338,28356,28368,28388,28424,28429,28459,28478,28480,28497,28543,28603,28619,28623,28645,28649,28669,28707,28711,28765,28777,28829,28839,28927,28938,28946,28950,28981,28999,29058,29060,29109,29133,29163,29206,29235,29252,29314,29323,29551,29566,29585,29602,29657,29736,29742,29746,29808,29837,29862,29867,29891,29993,29994,30009,30050,30057,30063,30064,30125,30136,30153,30158,30169,30178,30183,30206,30232,30233,30244,30268,30269,30305,30323,30337,30341,30343,30365,30424,30447,30454,30458,30474,30484,30492,30508,30535,30540,30571,30576,30579,30595,30649,30673,30700,30718,30719,30735,30799,30827,30866,30881,31020,31052,31547,31625,31641,31662,31684,31690,31736,31829,32104,32235,32423,32547,32599,32634,32764,32769,32846,32949,33124,33174,33285,33341,33390,33405,33525,33575,33701,33900,33935,33983,34022,34069,34089,34186,34187,34386,34664,34676,34744,34758,34897,35153,35533,35578,36482,36612,36768,36806,37291,37296,37305,37470,37534,37653,38022,38086,39032,39352,39625,39722,39728,39737,39762,39782,40062,40188,40312,40361,40372,40626,40635,40846,40847,41297,41348,41529,41535,41765,41923,41930,42130,42331,42332,42435,42444,42661,42836,43144,43163,43224,43231,43305,43573,43673,43775,44028,44092,44124,44250,44325,44490,44716,44813,44823,44865,44924,45110,45523,45544,45718,45744,45832,45837,45921,46606,46710,46945,47573,47666,47865,47872,48348,48636,48917,48943,48972,49102,49170,49436,49438,49528,49549,49694,49827,50500,50507,50838,50981,50996,51130,51769,52008,52305,52455,52590,52808,53171,53678,53691,53747,54090,54135,54174,54485,54784,54816,54820,54835,54909,55237,55719,55936,56293,56308,56339,56344,56368,56489,56554,56607,56613,56692,56708,57355,57410,58007,58202);

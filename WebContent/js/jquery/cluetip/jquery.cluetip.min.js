/*
 * jQuery clueTip plugin
 * Version 1.0.6  (January 13, 2010)
 * @requires jQuery v1.3+
 *
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
 
/*
 *
 * Full list of options/settings can be found at the bottom of this file and at http://plugins.learningjquery.com/cluetip/
 *
 * Examples can be found at http://plugins.learningjquery.com/cluetip/demo/
 *
*/
(function(g){g.cluetip={version:"1.0.4"};var k,j,i,e,h,b,l,d;var f;g.fn.cluetip=function(n,m){if(typeof n=="object"){m=n;n=null}if(n=="destroy"){return this.unbind(".cluetip")}return this.each(function(L){var u=this,x=g(this);var I=g.extend(true,{},g.fn.cluetip.defaults,m||{},g.metadata?x.metadata():g.meta?x.data():{});var q=false;var B=+I.cluezIndex;x.data("thisInfo",{title:u.title,zIndex:B});var T=false,S=0;if(!g("#cluetip").length){g(['<div id="cluetip">','<div id="cluetip-outer">','<h3 id="cluetip-title"></h3>','<div id="cluetip-inner"></div>',"</div>",'<div id="cluetip-extra"></div>','<div id="cluetip-arrows" class="cluetip-arrows"></div>',"</div>"].join(""))[c](a).hide();k=g("#cluetip").css({position:"absolute"});i=g("#cluetip-outer").css({position:"relative",zIndex:B});j=g("#cluetip-inner");e=g("#cluetip-title");h=g("#cluetip-arrows");b=g('<div id="cluetip-waitimage"></div>').css({position:"absolute"}).insertBefore(k).hide()}var K=(I.dropShadow)?+I.dropShadowSteps:0;if(!l){l=g([]);for(var W=0;W<K;W++){l=l.add(g("<div></div>").css({zIndex:B-1,opacity:0.1,top:1+W,left:1+W}))}l.css({position:"absolute",backgroundColor:"#000"}).prependTo(k)}var G=x.attr(I.attribute),t=I.cluetipClass;if(!G&&!I.splitTitle&&!n){return true}if(I.local&&I.localPrefix){G=I.localPrefix+G}if(I.local&&I.hideLocal){g(G+":first").hide()}var H=parseInt(I.topOffset,10),D=parseInt(I.leftOffset,10);var C,U,z=isNaN(parseInt(I.height,10))?"auto":(/\D/g).test(I.height)?I.height:I.height+"px";var o,v,M,aa,O,V;var A=parseInt(I.width,10)||275,X=A+(parseInt(k.css("paddingLeft"),10)||0)+(parseInt(k.css("paddingRight"),10)||0)+K,E=this.offsetWidth,w,N,ab,P,p;var R;var J=(I.attribute!="title")?x.attr(I.titleAttribute):"";if(I.splitTitle){if(J==undefined){J=""}R=J.split(I.splitTitle);J=R.shift()}if(I.escapeTitle){J=J.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var s;function Z(){return false}var y=function(ac){if(!I.onActivate(x)){return false}T=true;k.removeClass().css({width:A});if(G==x.attr("href")){x.css("cursor",I.cursor)}if(I.hoverClass){x.addClass(I.hoverClass)}v=M=x.offset().top;w=x.offset().left;P=ac.pageX;O=ac.pageY;if(u.tagName.toLowerCase()!="area"){o=g(document).scrollTop();p=g(window).width()}if(I.positionBy=="fixed"){N=E+w+D;k.css({left:N})}else{N=(E>w&&w>X)||w+E+X+D>p?w-X-D:E+w+D;if(u.tagName.toLowerCase()=="area"||I.positionBy=="mouse"||E+X>p){if(P+20+X>p){k.addClass(" cluetip-"+t);N=(P-X-D)>=0?P-X-D-parseInt(k.css("marginLeft"),10)+parseInt(j.css("marginRight"),10):P-(X/2)}else{N=P+D}}var ad=N<0?ac.pageY+H:ac.pageY;k.css({left:(N>0&&I.positionBy!="bottomTop")?N:(P+(X/2)>p)?p/2-X/2:Math.max(P-(X/2),0),zIndex:x.data("thisInfo").zIndex});h.css({zIndex:x.data("thisInfo").zIndex+1})}U=g(window).height();if(n){if(typeof n=="function"){n=n(u)}j.html(n);Q(ad)}else{if(R){var af=R.length;j.html(R[0]);if(af>1){for(var ae=1;ae<af;ae++){j.append('<div class="split-body">'+R[ae]+"</div>")}}Q(ad)}else{if(!I.local&&G.indexOf("#")!=0){if(/\.(jpe?g|tiff?|gif|png)$/i.test(G)){j.html('<img src="'+G+'" alt="'+J+'" />');Q(ad)}else{if(q&&I.ajaxCache){j.html(q);Q(ad)}else{var aj=I.ajaxSettings.beforeSend,ag=I.ajaxSettings.error,ah=I.ajaxSettings.success,am=I.ajaxSettings.complete;var al={cache:false,url:G,beforeSend:function(an){if(aj){aj.call(u,an,k,j)}i.children().empty();if(I.waitImage){b.css({top:O+20,left:P+20,zIndex:x.data("thisInfo").zIndex-1}).show()}},error:function(an,ao){if(T){if(ag){ag.call(u,an,ao,k,j)}else{j.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(an,ao){q=I.ajaxProcess.call(u,an);if(T){if(ah){ah.call(u,an,ao,k,j)}j.html(q)}},complete:function(an,ao){if(am){am.call(u,an,ao,k,j)}d=g("#cluetip-inner img").length;if(d&&!g.browser.opera){g("#cluetip-inner img").bind("load error",function(){d--;if(d<1){b.hide();if(T){Q(ad)}}})}else{b.hide();if(T){Q(ad)}}}};var ai=g.extend(true,{},I.ajaxSettings,al);g.ajax(ai)}}}else{if(I.local){var ak=g(G+(/#\S+$/.test(G)?"":":eq("+L+")")).clone(true).show();j.html(ak);Q(ad)}}}}};var Q=function(ae){k.addClass("cluetip-"+t);if(I.stayOpenHover){k.bind("mouseenter.cluetip",function(ai){clearTimeout(f)});k.bind("mouseleave.cluetip",function(ai){Y(ai);k.unbind("mouseleave.cluetip")})}if(I.truncate){var af=j.text().slice(0,I.truncate)+"...";j.html(af)}function ac(){}J?e.show().html(J):(I.showTitle)?e.show().html("&nbsp;"):e.hide();if(I.sticky){var ad=g('<div id="cluetip-close"><a href="#">'+I.closeText+"</a></div>");(I.closePosition=="bottom")?ad.appendTo(j):(I.closePosition=="title")?ad.prependTo(e):ad.prependTo(j);ad.bind("click.cluetip",function(){F();return false});if(I.mouseOutClose){k.bind("mouseleave.cluetip",function(){F()})}else{k.unbind("mouseleave.cluetip")}}var ag="";i.css({zIndex:x.data("thisInfo").zIndex,overflow:z=="auto"?"visible":"auto",height:z});C=z=="auto"?Math.max(k.outerHeight(),k.height()):parseInt(z,10);aa=M;V=o+U;if(I.positionBy=="fixed"){aa=M-I.dropShadowSteps+H}else{if((N<P&&Math.max(N,0)+X>P)||I.positionBy=="bottomTop"){if(M+C+H>V&&O-o>C+H){aa=O-C-H;ag="top"}else{aa=O+H;ag="bottom"}}else{if(M+C+H>V){aa=(C>=U)?o:V-C-H}else{if(x.css("display")=="block"||u.tagName.toLowerCase()=="area"||I.positionBy=="mouse"){aa=ae-H}else{aa=M-I.dropShadowSteps}}}}if(ag==""){N<w?ag="left":ag="right"}k.css({top:aa+"px"}).removeClass().addClass("clue-"+ag+"-"+t).addClass(" cluetip-"+t);if(I.arrows){var ah=(M-aa-I.dropShadowSteps);h.css({top:(/(left|right)/.test(ag)&&N>=0&&ah>0)?ah+"px":/(left|right)/.test(ag)?0:""}).show()}else{h.hide()}l.hide();k.hide()[I.fx.open](I.fx.open!="show"&&I.fx.openSpeed);if(I.dropShadow){l.css({height:C,width:A,zIndex:x.data("thisInfo").zIndex-1}).show()}if(g.fn.bgiframe){k.bgiframe()}if(I.delayedClose>0){S=setTimeout(F,I.delayedClose)}I.onShow.call(u,k,j)};var Y=function(ac){T=false;b.hide();if(!I.sticky||(/click|toggle/).test(I.activation)){if(I.delayedHide>0){f=setTimeout(function(){F()},I.delayedHide)}else{F()}clearTimeout(S)}if(I.hoverClass){x.removeClass(I.hoverClass)}};var F=function(){i.parent().hide().removeClass();I.onHide.call(u,k,j);x.removeClass("cluetip-clicked");if(J){x.attr(I.titleAttribute,J)}x.css("cursor","");if(I.arrows){h.css({top:""})}};g(document).bind("hideCluetip",function(ac){F()});if((/click|toggle/).test(I.activation)){x.bind("click.cluetip",function(ac){if(k.is(":hidden")||!x.is(".cluetip-clicked")){y(ac);g(".cluetip-clicked").removeClass("cluetip-clicked");x.addClass("cluetip-clicked")}else{Y(ac)}this.blur();return false})}else{if(I.activation=="focus"){x.bind("focus.cluetip",function(ac){y(ac)});x.bind("blur.cluetip",function(ac){Y(ac)})}else{x[I.clickThrough?"unbind":"bind"]("click",Z);var r=function(ac){if(I.tracking==true){var ae=N-ac.pageX;var ad=aa?aa-ac.pageY:M-ac.pageY;x.bind("mousemove.cluetip",function(af){k.css({left:af.pageX+ae,top:af.pageY+ad})})}};if(g.fn.hoverIntent&&I.hoverIntent){x.hoverIntent({sensitivity:I.hoverIntent.sensitivity,interval:I.hoverIntent.interval,over:function(ac){y(ac);r(ac)},timeout:I.hoverIntent.timeout,out:function(ac){Y(ac);x.unbind("mousemove.cluetip")}})}else{x.bind("mouseenter.cluetip",function(ac){y(ac);r(ac)}).bind("mouseleave.cluetip",function(ac){Y(ac);x.unbind("mousemove.cluetip")})}x.bind("mouseenter.cluetip",function(ac){x.attr("title","")}).bind("mouseleave.cluetip",function(ac){x.attr("title",x.data("thisInfo").title)})}}})};g.fn.cluetip.defaults={width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:false,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,delayedHide:0,stayOpenHover:false,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(m){return true},onShow:function(n,m){},onHide:function(n,m){},ajaxCache:true,ajaxProcess:function(m){m=m.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return m},ajaxSettings:{dataType:"html"},debug:false};var c="appendTo",a="body";g.cluetip.setup=function(m){if(m&&m.insertionType&&(m.insertionType).match(/appendTo|prependTo|insertBefore|insertAfter/)){c=m.insertionType}if(m&&m.insertionElement){a=m.insertionElement}}})(jQuery);
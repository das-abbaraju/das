(SELECT accounts.id AS conID, ROUND(100 * (0.16065856 + (0.08340467 * AVG(CASE generalcontractors.flag WHEN 'Green' THEN 3 WHEN 'Amber' THEN 2 ELSE 1 END))
                       + (0.20098547 * CASE contractor_info.paymentMethod WHEN 'Check' THEN 1 ELSE 0 END)
                       + (0.461150415 * IFNULL(contractor_info.ccOnFile,0))
                       + (0.065215233 * IFNULL(contractor_info.ccExpiration > contractor_info.paymentExpires,0))
                       + (0.050759683 * CASE WHEN payingFacilities <= 1 THEN 1 WHEN payingFacilities <= 2 THEN 2 WHEN payingFacilities <= 12 THEN 3 ELSE 3.5 END)
                      )) AS predictor
                      FROM accounts
                      JOIN contractor_info ON contractor_info.id = accounts.id
                      JOIN generalcontractors ON generalcontractors.subID = contractor_info.id
                      JOIN accounts clients ON clients.id = generalcontractors.genID AND clients.type = 'Operator'
                      GROUP BY accounts.id )